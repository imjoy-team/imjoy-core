<docs>
[TODO: write documentation for this plugin.]
</docs>

<config lang="json">
{
  "name": "Test Web Worker Plugin 2",
  "type": "web-worker",
  "tags": [],
  "ui": "",
  "version": "0.1.0",
  "api_version": "0.1.7",
  "url": "",
  "description": "[TODO: describe this plugin with one sentence.]",
  "icon": "extension",
  "inputs": null,
  "outputs": null,
  "env": "",
  "requirements": [],
  "dependencies": []
}
</config>

<script lang="javascript">
class Cat{
  constructor(name, color, age, clean){
    this.name = name
    this.color = color
    this.age = age
    this.clean = clean
  }
}

api.registerCodec({'name': 'cat', 'type': Cat, 'encoder': (obj)=>{
  return {name: obj.name, color: obj.color, age: obj.age, clean: obj.clean}
}, 'decoder': (encoded_obj)=>{
  return new Cat(encoded_obj.name, encoded_obj.color, encoded_obj.age, encoded_obj.clean)
}})

class ImJoyPlugin {
  async setup() {
  }

  async run(my) {
    console.log('running in plugin 2.')
    return my
  }

  async square(arg) {
    return arg*arg
  }

  async wash(cat){
    if(!cat.clean)
    cat.clean = true
    return cat
  }
}

api.export(new ImJoyPlugin())
</script>

<attachment name='some_text_data'>
hello world!
</attachment>
